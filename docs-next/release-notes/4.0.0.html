<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js coal">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>4.0.0 - DipDup Documentation</title>


        <!-- Custom HTML head -->
        
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../book.css">
        <link rel="stylesheet" href="../mdbook-admonish.css">

    </head>
    <body>
        <!-- Provide site root to javascript -->
        <!-- NOTE: Fixed coal -->
        <script type="text/javascript">
            var path_to_root = "../";
            var default_theme = "coal";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('coal')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="../index.html">Introduction</a></li><li class="chapter-item expanded affix "><li class="part-title">User Guide</li><li class="chapter-item expanded "><a href="../quickstart.html"><strong aria-hidden="true">1.</strong> Quickstart</a></li><li class="chapter-item expanded "><a href="../getting-started/index.html"><strong aria-hidden="true">2.</strong> Getting started</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../getting-started/installation.html"><strong aria-hidden="true">2.1.</strong> Installation</a></li><li class="chapter-item expanded "><a href="../getting-started/core-concepts.html"><strong aria-hidden="true">2.2.</strong> Core concepts</a></li><li class="chapter-item expanded "><a href="../getting-started/creating-config.html"><strong aria-hidden="true">2.3.</strong> Creating config</a></li><li class="chapter-item expanded "><a href="../getting-started/project-structure.html"><strong aria-hidden="true">2.4.</strong> Project structure</a></li><li class="chapter-item expanded "><a href="../getting-started/defining-models.html"><strong aria-hidden="true">2.5.</strong> Defining models</a></li><li class="chapter-item expanded "><a href="../getting-started/implementing-handlers.html"><strong aria-hidden="true">2.6.</strong> Implementing handlers</a></li><li class="chapter-item expanded "><a href="../getting-started/templates-and-variables.html"><strong aria-hidden="true">2.7.</strong> Templates and variables</a></li></ol></li><li class="chapter-item expanded "><a href="../indexes/index.html"><strong aria-hidden="true">3.</strong> Indexes</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../indexes/big_map.html"><strong aria-hidden="true">3.1.</strong> Big map keys</a></li><li class="chapter-item expanded "><a href="../indexes/event.html"><strong aria-hidden="true">3.2.</strong> Contract events</a></li><li class="chapter-item expanded "><a href="../indexes/head.html"><strong aria-hidden="true">3.3.</strong> Head blocks</a></li><li class="chapter-item expanded "><a href="../indexes/operation.html"><strong aria-hidden="true">3.4.</strong> Operations</a></li><li class="chapter-item expanded "><a href="../indexes/token_transfer.html"><strong aria-hidden="true">3.5.</strong> Token transfers</a></li></ol></li><li class="chapter-item expanded "><a href="../graphql/index.html"><strong aria-hidden="true">4.</strong> GraphQL API</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../graphql/hasura.html"><strong aria-hidden="true">4.1.</strong> Hasura integration</a></li><li class="chapter-item expanded "><a href="../graphql/rest.html"><strong aria-hidden="true">4.2.</strong> REST endpoints</a></li><li class="chapter-item expanded "><a href="../graphql/genql.html"><strong aria-hidden="true">4.3.</strong> GenQL</a></li></ol></li><li class="chapter-item expanded "><a href="../advanced/index.html"><strong aria-hidden="true">5.</strong> Advanced usage</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../advanced/datasources.html"><strong aria-hidden="true">5.1.</strong> Datasources</a></li><li class="chapter-item expanded "><a href="../advanced/hooks.html"><strong aria-hidden="true">5.2.</strong> Hooks</a></li><li class="chapter-item expanded "><a href="../advanced/event-hooks.html"><strong aria-hidden="true">5.3.</strong> Event hooks</a></li><li class="chapter-item expanded "><a href="../advanced/jobs.html"><strong aria-hidden="true">5.4.</strong> Job scheduler</a></li><li class="chapter-item expanded "><a href="../advanced/reindexing.html"><strong aria-hidden="true">5.5.</strong> Reindexing</a></li><li class="chapter-item expanded "><a href="../advanced/feature-flags.html"><strong aria-hidden="true">5.6.</strong> Feature flags</a></li><li class="chapter-item expanded "><a href="../advanced/sql.html"><strong aria-hidden="true">5.7.</strong> SQL scripts</a></li><li class="chapter-item expanded "><a href="../advanced/performance.html"><strong aria-hidden="true">5.8.</strong> Improving performance</a></li><li class="chapter-item expanded "><a href="../advanced/context.html"><strong aria-hidden="true">5.9.</strong> Callback context (ctx)</a></li><li class="chapter-item expanded "><a href="../advanced/internal-models.html"><strong aria-hidden="true">5.10.</strong> Internal models</a></li><li class="chapter-item expanded "><a href="../advanced/index-factories.html"><strong aria-hidden="true">5.11.</strong> Index factories</a></li><li class="chapter-item expanded "><a href="../advanced/metadata-interface.html"><strong aria-hidden="true">5.12.</strong> Metadata interface</a></li></ol></li><li class="chapter-item expanded "><a href="../deployment/index.html"><strong aria-hidden="true">6.</strong> Deployment and operations</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../deployment/database-engines.html"><strong aria-hidden="true">6.1.</strong> Database engines</a></li><li class="chapter-item expanded "><a href="../deployment/docker.html"><strong aria-hidden="true">6.2.</strong> Running in Docker</a></li><li class="chapter-item expanded "><a href="../deployment/sentry.html"><strong aria-hidden="true">6.3.</strong> Sentry integration</a></li><li class="chapter-item expanded "><a href="../deployment/prometheus.html"><strong aria-hidden="true">6.4.</strong> Prometheus integration</a></li><li class="chapter-item expanded "><a href="../deployment/logging.html"><strong aria-hidden="true">6.5.</strong> Logging</a></li><li class="chapter-item expanded "><a href="../deployment/backups.html"><strong aria-hidden="true">6.6.</strong> Backup and restore</a></li><li class="chapter-item expanded "><a href="../deployment/monitoring.html"><strong aria-hidden="true">6.7.</strong> Monitoring</a></li></ol></li><li class="chapter-item expanded "><a href="../faq.html"><strong aria-hidden="true">7.</strong> F.A.Q.</a></li><li class="chapter-item expanded "><a href="../troubleshooting.html"><strong aria-hidden="true">8.</strong> Troubleshooting</a></li><li class="chapter-item expanded affix "><li class="part-title">Examples</li><li class="chapter-item expanded "><a href="../examples/demo-projects.html"><strong aria-hidden="true">9.</strong> Demo projects</a></li><li class="chapter-item expanded "><a href="../examples/built-with-dipdup.html"><strong aria-hidden="true">10.</strong> Built with DipDup</a></li><li class="chapter-item expanded affix "><li class="part-title">Standalone Services</li><li class="chapter-item expanded "><a href="../services/mempool.html"><strong aria-hidden="true">11.</strong> mempool</a></li><li class="chapter-item expanded "><a href="../services/metadata.html"><strong aria-hidden="true">12.</strong> metadata</a></li><li class="chapter-item expanded affix "><li class="part-title">Reference Guide</li><li class="chapter-item expanded "><a href="../cli-reference.html"><strong aria-hidden="true">13.</strong> Command-line reference</a></li><li class="chapter-item expanded "><a href="../config/index.html"><strong aria-hidden="true">14.</strong> Config file reference</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../config/reference.html"><strong aria-hidden="true">14.1.</strong> Full reference</a></li><li class="chapter-item expanded "><a href="../config/advanced.html"><strong aria-hidden="true">14.2.</strong> advanced</a></li><li class="chapter-item expanded "><a href="../config/contracts.html"><strong aria-hidden="true">14.3.</strong> contracts</a></li><li class="chapter-item expanded "><a href="../config/custom.html"><strong aria-hidden="true">14.4.</strong> custom</a></li><li class="chapter-item expanded "><a href="../config/database.html"><strong aria-hidden="true">14.5.</strong> database</a></li><li class="chapter-item expanded "><a href="../config/datasources.html"><strong aria-hidden="true">14.6.</strong> datasources</a></li><li class="chapter-item expanded "><a href="../config/hasura.html"><strong aria-hidden="true">14.7.</strong> hasura</a></li><li class="chapter-item expanded "><a href="../config/hooks.html"><strong aria-hidden="true">14.8.</strong> hooks</a></li><li class="chapter-item expanded "><a href="../config/indexes.html"><strong aria-hidden="true">14.9.</strong> indexes</a></li><li class="chapter-item expanded "><a href="../config/jobs.html"><strong aria-hidden="true">14.10.</strong> jobs</a></li><li class="chapter-item expanded "><a href="../config/logging.html"><strong aria-hidden="true">14.11.</strong> logging</a></li><li class="chapter-item expanded "><a href="../config/package.html"><strong aria-hidden="true">14.12.</strong> package</a></li><li class="chapter-item expanded "><a href="../config/prometheus.html"><strong aria-hidden="true">14.13.</strong> prometheus</a></li><li class="chapter-item expanded "><a href="../config/sentry.html"><strong aria-hidden="true">14.14.</strong> sentry</a></li><li class="chapter-item expanded "><a href="../config/spec_version.html"><strong aria-hidden="true">14.15.</strong> spec_version</a></li><li class="chapter-item expanded "><a href="../config/templates.html"><strong aria-hidden="true">14.16.</strong> templates</a></li></ol></li><li class="chapter-item expanded "><li class="part-title">What's New</li><li class="chapter-item expanded "><a href="../CHANGELOG.html"><strong aria-hidden="true">15.</strong> Changelog</a></li><li class="chapter-item expanded "><a href="../release-notes/index.html"><strong aria-hidden="true">16.</strong> Release notes</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../release-notes/6.2.0.html"><strong aria-hidden="true">16.1.</strong> 6.2.0</a></li><li class="chapter-item expanded "><a href="../release-notes/6.0.0.html"><strong aria-hidden="true">16.2.</strong> 6.0.0</a></li><li class="chapter-item expanded "><a href="../release-notes/5.1.0.html"><strong aria-hidden="true">16.3.</strong> 5.1.0</a></li><li class="chapter-item expanded "><a href="../release-notes/5.0.0.html"><strong aria-hidden="true">16.4.</strong> 5.0.0</a></li><li class="chapter-item expanded "><a href="../release-notes/4.2.0.html"><strong aria-hidden="true">16.5.</strong> 4.2.0</a></li><li class="chapter-item expanded "><a href="../release-notes/4.1.0.html"><strong aria-hidden="true">16.6.</strong> 4.1.0</a></li><li class="chapter-item expanded "><a href="../release-notes/4.0.0.html" class="active"><strong aria-hidden="true">16.7.</strong> 4.0.0</a></li></ol></li><li class="chapter-item expanded "><li class="part-title">Community</li><li class="chapter-item expanded "><a href="../CONTRIBUTING.html"><strong aria-hidden="true">17.</strong> Contribution guide</a></li><li class="chapter-item expanded "><a href="../LICENSE.html"><strong aria-hidden="true">18.</strong> MIT License</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-button">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <div id="theme-list" class="hidden"></div>

                        <script type="text/javascript">
                            var theme_toggle = document.getElementById('theme-toggle');

                            function toggleTheme() {
                                var html = document.querySelector('html');
                                var theme = html.classList.contains('coal') ? 'light' : 'coal';
                                html.classList.remove('light');
                                html.classList.remove('coal');
                                html.classList.add(theme);
                                try { localStorage.setItem('mdbook-theme', theme); } catch(e) { }
                            }

                            theme_toggle.addEventListener('click', toggleTheme);
                        </script>
                        <a class="icon-button" id="stable">stable</a>
                        <a class="icon-button" id="latest">latest</a>
                        <script type="text/javascript">
                            stable_a = document.getElementById("stable");
                            latest_a = document.getElementById("latest");
                            if (window.location.href.includes("docs.")) {
                                stable_a.style.color = "dimgray";
                                latest_a.setAttribute('href', window.location.href.replace('docs.', 'docs-next.'));
                            }
                            else if (window.location.href.includes('docs-next.')) {
                                latest_a.style.color = "dimgray";
                                stable_a.setAttribute('href', window.location.href.replace('docs-next.', 'docs.'));
                            }
                        </script>

                    </div>

                    <div class="menu-title">
                        <img class="logo" src="..//theme/header.png" alt="DipDup logo" />
                    </div>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/dipdup-io/dipdup.git" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="400"><a class="header" href="#400">4.0.0</a></h1>
<h2 id="-breaking-changes"><a class="header" href="#-breaking-changes">âš  Breaking Changes</a></h2>
<ul>
<li><code>run --oneshot</code> option is removed. The oneshot mode (DipDup stops after the sync is finished) applies automatically when <code>last_level</code> field is set in the index config.</li>
<li><code>clear-cache</code> command is removed. Use <code>cache clear</code> instead.</li>
</ul>
<h2 id="migration-from-3x"><a class="header" href="#migration-from-3x">Migration from 3.x</a></h2>
<ul>
<li>Run <code>dipdup init</code> command to generate <code>on_synchronized</code> hook stubs.</li>
<li>Run <code>dipdup schema approve</code> command on every database you want to use with 4.0.0. Running <code>dipdup migrate</code> is not necessary since <code>spec_version</code> hasn't changed in this release.</li>
</ul>
<h2 id="whats-new"><a class="header" href="#whats-new">What's New</a></h2>
<h3 id="performance-optimizations"><a class="header" href="#performance-optimizations">Performance optimizations</a></h3>
<p>Overall indexing performance has been significantly improved. Key highlights:</p>
<ul>
<li>Configuration files are loaded 10x times faster. The more indexes in the project, the more noticeable difference is.</li>
<li>Significantly reduced CPU usage in realtime mode.</li>
<li>Datasource default HTTP connection options optimized for a reasonable balance between resource consumption and indexing speed.</li>
</ul>
<p>Also, two new flags were added to improve DipDup performance in several scenarios: <code>merge_subscriptions</code> and <code>early_relatime</code>.  See <a href="#new-cli-commands-and-flags">this paragraph</a> for details.</p>
<h3 id="configurable-action-on-reindex"><a class="header" href="#configurable-action-on-reindex">Configurable action on reindex</a></h3>
<p>There are several reasons that trigger reindexing:</p>
<div class="table-wrapper"><table><thead><tr><th>reason</th><th>description</th></tr></thead><tbody>
<tr><td><code>manual</code></td><td>Reindexing triggered manually from callback with <code>ctx.reindex</code>.</td></tr>
<tr><td><code>migration</code></td><td>Applied migration requires reindexing. Check release notes before switching between major DipDup versions to be prepared.</td></tr>
<tr><td><code>rollback</code></td><td>Reorg message received from TzKT, and can not be processed.</td></tr>
<tr><td><code>config_modified</code></td><td>One of the index configs has been modified.</td></tr>
<tr><td><code>schema_modified</code></td><td>Database schema has been modified. Try to avoid manual schema modifications in favor of <a href="../advanced/sql.html">SQL hooks</a>.</td></tr>
</tbody></table>
</div>
<p>Now it is possible to configure desirable action on reindexing triggered by the specific reason.</p>
<div class="table-wrapper"><table><thead><tr><th>action</th><th>description</th></tr></thead><tbody>
<tr><td><code>exception</code> (default)</td><td>Raise <code>ReindexingRequiredError</code> and quit with error code. The safest option since you can trigger reindexing accidentally, e.g., by a typo in config. Don't forget to set up the correct restart policy when using it with containers.</td></tr>
<tr><td><code>wipe</code></td><td>Drop the whole database and start indexing from scratch. Be careful with this option!</td></tr>
<tr><td><code>ignore</code></td><td>Ignore the event and continue indexing as usual. It can lead to unexpected side-effects up to data corruption; make sure you know what you are doing.</td></tr>
</tbody></table>
</div>
<p>To configure actions for each reason, add the following section to DipDup config:</p>
<pre><code class="language-yaml">advanced:
  ...
  reindex:
    manual: wipe
    migration: exception
    rollback: ignore
    config_modified: exception
    schema_modified: exception
</code></pre>
<h3 id="new-cli-commands-and-flags"><a class="header" href="#new-cli-commands-and-flags">New CLI commands and flags</a></h3>
<div class="table-wrapper"><table><thead><tr><th>command or flag</th><th>description</th></tr></thead><tbody>
<tr><td><code>cache show</code></td><td>Get information about file caches used by DipDup.</td></tr>
<tr><td><code>config export</code></td><td>Print config after resolving all links and variables. Add <code>--unsafe</code> option to substitute environment variables; default values from config will be used otherwise.</td></tr>
<tr><td><code>run --early-realtime</code></td><td>Establish a realtime connection before all indexes are synchronized.</td></tr>
<tr><td><code>run --merge-subscriptions</code></td><td>Subscribe to all operations/big map diffs during realtime indexing. This flag helps to avoid reaching TzKT subscriptions limit (currently 10000 channels). Keep in mind that this option could significantly improve RAM consumption depending on the time required to perform a sync.</td></tr>
<tr><td><code>status</code></td><td>Print the current status of indexes from the database.</td></tr>
</tbody></table>
</div>
<h3 id="advanced-top-level-config-section"><a class="header" href="#advanced-top-level-config-section"><code>advanced</code> top-level config section</a></h3>
<p>This config section allows users to tune system-wide options, either experimental or unsuitable for generic configurations.</p>
<div class="table-wrapper"><table><thead><tr><th>field</th><th>description</th></tr></thead><tbody>
<tr><td><code>early_realtime</code><br><code>merge_subscriptions</code><br><code>postpone_jobs</code></td><td>Another way to set <code>run</code> command flags. Useful for maintaining per-deployment configurations.</td></tr>
<tr><td><code>reindex</code></td><td>Configure action on reindexing triggered. See <a href="#configurable-action-on-reindex">this paragraph</a> for details.</td></tr>
</tbody></table>
</div>
<p>CLI flags have priority over self-titled <code>AdvancedConfig</code> fields.</p>
<h3 id="aiosignalrcore-replaced-with-pysignalr"><a class="header" href="#aiosignalrcore-replaced-with-pysignalr"><code>aiosignalrcore</code> replaced with <code>pysignalr</code></a></h3>
<p>It may not be the most noticeable improvement for end-user, but it still deserves a separate paragraph in this article.</p>
<p>Historically, DipDup used our own fork of <code>signalrcore</code> library named <code>aiosignalrcore</code>. This project aimed to replace the synchronous <code>websocket-client</code> library with asyncio-ready <code>websockets</code>. Later we discovered that required changes make it hard to maintain backward compatibility, so we have decided to rewrite this library from scratch. So now you have both a modern and reliable library for SignalR protocol and a much more stable DipDup. Ain't it nice?</p>
<h2 id="changes-since-313"><a class="header" href="#changes-since-313">Changes since 3.1.3</a></h2>
<p>This is a combined changelog of -rc versions released since the last stable release until this one.</p>
<h3 id="added"><a class="header" href="#added">Added</a></h3>
<ul>
<li>cli: Added <code>run --early-realtime</code> flag to establish a realtime connection before all indexes are synchronized.</li>
<li>cli: Added'run --merge-subscriptions`  flag to subscribe to all operations/big map diffs during realtime indexing.</li>
<li>cli: Added <code>status</code> command to print the current status of indexes from the database.</li>
<li>cli: Added <code>config export [--unsafe]</code> command to print config after resolving all links and variables.</li>
<li>cli: Added <code>cache show</code> command to get information about file caches used by DipDup.</li>
<li>config: Added <code>first_level</code> and <code>last_level</code> optional fields to <code>TemplateIndexConfig</code>. These limits are applied after ones from the template itself.</li>
<li>config: Added <code>daemon</code> boolean field to <code>JobConfig</code> to run a single callback indefinitely. Conflicts with <code>crontab</code> and <code>interval</code> fields.</li>
<li>config: Added <code>advanced</code> top-level section.</li>
<li>hooks: Added <code>on_synchronized</code> hook, which fires each time all indexes reach realtime state.</li>
</ul>
<h3 id="fixed"><a class="header" href="#fixed">Fixed</a></h3>
<ul>
<li>cli: Fixed config not being verified when invoking some commands.</li>
<li>cli: Fixed crashes and output inconsistency when piping DipDup commands.</li>
<li>cli: Fixed missing <code>schema approve --hashes</code> argument.</li>
<li>cli: Fixed <code>schema wipe --immune</code> flag being ignored.</li>
<li>codegen: Fixed contract address used instead of an alias when typename is not set.</li>
<li>codegen: Fixed generating callback arguments for untyped operations.</li>
<li>codegen: Fixed missing imports in handlers generated during init.</li>
<li>coinbase: Fixed possible data inconsistency caused by caching enabled for method <code>get_candles</code>.</li>
<li>hasura: Fixed unnecessary reconfiguration in restart.</li>
<li>http: Fixed increasing sleep time between failed request attempts.</li>
<li>index: Fixed <code>CallbackError</code> raised instead of <code>ReindexingRequiredError</code> in some cases.</li>
<li>index: Fixed crash while processing storage of some contracts.</li>
<li>index: Fixed incorrect log messages, remove duplicate ones.</li>
<li>index: Fixed invocation of head index callback.</li>
<li>index: Fixed matching of untyped operations filtered by <code>source</code> field (<a href="https://github.com/pravin-d">@pravin-d</a>).</li>
<li>tzkt: Fixed filtering of big map diffs by the path.</li>
<li>tzkt: Fixed <code>get_originated_contracts</code> and <code>get_similar_contracts</code> methods whose output was limited to <code>HTTPConfig.batch_size</code> field.</li>
<li>tzkt: Fixed lots of SignalR bugs by replacing <code>aiosignalrcore</code> library with <code>pysignalr</code>.</li>
<li>tzkt: Fixed processing operations with entrypoint <code>default</code>.</li>
<li>tzkt: Fixed regression in processing migration originations.</li>
<li>tzkt: Fixed resubscribing when realtime connectivity is lost for a long time.</li>
<li>tzkt: Fixed sending useless subscription requests when adding indexes in runtime.</li>
</ul>
<h3 id="changed"><a class="header" href="#changed">Changed</a></h3>
<ul>
<li>cli: <code>schema wipe</code> command now requires confirmation when invoked in the interactive shell.</li>
<li>cli: <code>schema approve</code> command now also causes a recalculation of schema and index config hashes.</li>
<li>index: DipDup will recalculate respective hashes if reindexing is triggered with <code>config_modified: ignore</code> or <code>schema_modified: ignore</code> in advanced config.</li>
</ul>
<h3 id="removed"><a class="header" href="#removed">Removed</a></h3>
<ul>
<li>cli: Removed deprecated <code>run --oneshot</code> argument and <code>clear-cache</code> command.</li>
</ul>
<h3 id="performance"><a class="header" href="#performance">Performance</a></h3>
<ul>
<li>config: Configuration files are loaded 10x times faster.</li>
<li>index: Checks performed on each iteration of the main DipDup loop are slightly faster now.</li>
<li>index: Number of operations processed by matcher reduced by 40%-95% depending on the number of addresses and entrypoints used.</li>
<li>tzkt: Improved performance of response deserialization.</li>
<li>tzkt: Rate limit was increased. Try to set <code>connection_timeout</code> to a higher value if requests fail with <code>ConnectionTimeout</code> exception.</li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../release-notes/4.1.0.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next" href="../CONTRIBUTING.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../release-notes/4.1.0.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="../CONTRIBUTING.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script type="text/javascript">
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../searcher.js" type="text/javascript" charset="utf-8"></script>

        <script src="../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->


    </body>
</html>
