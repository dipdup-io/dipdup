---
title: "Monitoring"
description: "To perform up-to-date and freshness checks, DipDup provides a standard REST endpoint you can use together with Betteruptime or similar services that can search for a keyword in the response."
---

<!-- markdownlint-disable -->

# Monitoring

Important to monitor to know that your indexer is working properly. Multiple methods:

1. Prometheus
4. Internal tables
3. API endpoint
2. Sentry

## URI format

```text
https://<your-indexer-host>/api/rest/dipdup_head_status?name=<datasource>
```

If you have camel case enabled in the Hasura config:

```text
https://<your-indexer-host>/api/rest/dipdupHeadStatus?name=<datasource>
```

For example:

* [https://domains.dipdup.net/api/rest/dipdup_head_status?name=mainnet](https://domains.dipdup.net/api/rest/dipdup_head_status?name=mainnet)
* [https://juster.dipdup.net/api/rest/dipdupHeadStatus?name=mainnet](https://domains.dipdup.net/api/rest/dipdup_head_status?name=mainnet)

### Response

If the (latest block) head subscription state was updated less than **three minutes** ago, everything is **OK**:

```json
{
  "dipdup_head_status": [
    {
      "status": "OK"
    }
  ]
}
```

Otherwise, the state is considered **OUTDATED**:

```json
{
  "dipdup_head_status": [
    {
      "status": "OUTDATED"
    }
  ]
}
```

### Custom checks

The default check looks like the following:

```sql
{{ #include ../src/dipdup/sql/dipdup_status.sql }}
```

You can also create your custom alert endpoints using SQL views and functions and then convert them to Hasura REST endpoints.

## Sentry integration

Sentry is an error tracking software that can be used either as a service or on-premise. It dramatically improves the troubleshooting experience and requires nearly zero configuration. To start catching exceptions with Sentry in your project, add the following section in `dipdup.yaml` config:

```yaml [dipdup.yaml]
sentry:
  dsn: https://...
  environment: dev
  debug: False
```

You can obtain Sentry DSN from the web interface at _Settings -> Projects -> <project\_name> -> Client Keys (DSN)_. The cool thing is that if you catch an exception and suspect there's a bug in DipDup, you can share this event with us using a public link (created at _Share_ menu).

## Prometheus integration

DipDup provides basic integration with the Prometheus monitoring system by exposing some metrics.

When running DipDup in Docker make sure that the Prometheus instance is in the same network.

## Available metrics

The following metrics are exposed under `dipdup` namespace:

| metric name                                    | description                                    |
| ---------------------------------------------- | ---------------------------------------------- |
| `dipdup_indexes_total`                         | Number of indexes in operation by status       |
| `dipdup_index_total_sync_duration_seconds`     | Duration of the last synchronization           |
| `dipdup_index_total_realtime_duration_seconds` | Duration of the last realtime queue processing |
| `dipdup_index_levels_to_sync_total`            | Number of levels to reach synced state         |
| `dipdup_index_levels_to_realtime_total`        | Number of levels to reach realtime state       |
| `dipdup_index_handlers_matched_total`          | Index total hits                               |
| `dipdup_datasource_head_updated_timestamp`     | Timestamp of the last head update              |
| `dipdup_datasource_rollbacks_total`            | Number of rollbacks                            |
| `dipdup_http_errors_total`                     | Number of HTTP errors                          |

Also, DipDup exposes the following metrics for compatibility with Subsquid Cloud:

| metric name                                | description                                               |
| ------------------------------------------ | --------------------------------------------------------- |
| `sqd_processor_last_block`                 | Level of the last processed block from Subsquid Network   |
| `sqd_processor_chain_height`               | Current chain height as reported by Subsquid Network      |
| `sqd_processor_archive_http_errors_in_row` | Number of consecutive failed requests to Subsquid Network |

If you need more complex metrics, consider querying [Internal tables](../1.getting-started/5.database.md#internal-tables).


---
title: "Logging"
description: "To control the number of logs DipDup produces, set the `logging` field in config. It can be either a string or a mapping from logger names to logging levels."
---

# Logging

To control the number of logs DipDup produces, set the `logging` field in config. It can be either   a string or a mapping from logger names to logging levels.

```yaml [dipdup.yaml]
# Configure dipdup and package loggers
logging: WARN

# Increase verbosity of some loggers
logging:
  dipdup.database: DEBUG
  aiosqlite: DEBUG

# Enable ALL logs
logging:
  '': DEBUG
```

By default only `dipdup` and `{{ project.package }}` namespace loggers are configured. DipDup loggers are usually named after the corresponding module, e.g., `dipdup.database` or `dipdup.index`.

Keep in mind, that excessive logging can affect indexing performance.
