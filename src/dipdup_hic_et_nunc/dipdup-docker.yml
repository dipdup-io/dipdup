spec_version: 0.0.1
package: dipdup_hic_et_nunc

database:
  kind: postgres
  host: db
  port: 5432
  user: dipdup
  database: dipdup
  password: ${POSTGRES_PASSWORD:-changeme}

contracts:
  HEN_objkts: 
    address: ${HEN_OBJKTS:-KT1Hkg5qeNhfwpKW4fXvq7HGZB9z2EnmCCA9}
  HEN_minter: 
    address: ${HEN_MINTER:-KT1RJ6PbjHpwc3M5rw5s2Nbmefwbuwbdxton}

datasources:
  tzkt_mainnet:
    kind: tzkt
    url: ${TZKT_URL:-https://staging.api.tzkt.io}

indexes:
  operations_mainnet:
    kind: operation
    datasource: tzkt_mainnet
    contract: HEN_objkts
    first_block: 0
    handlers:

      - callback: on_mint
        pattern:
          - destination: HEN_objkts
            entrypoint: mint_OBJKT
          - destination: HEN_minter
            entrypoint: mint

      - callback: on_transfer
        pattern:
          - destination: HEN_minter
            entrypoint: transfer
