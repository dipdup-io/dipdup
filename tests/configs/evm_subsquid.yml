spec_version: 1.2
package: uniswap_indexer

datasources:
  subsquid_eth_mainnet:
    kind: evm.subsquid
    url: ${ARCHIVE_URI:-https://eth.archive.subsquid.io}
    node_url: ${INFURA_URI:-}

contracts:
  uniswap_router_mainnet:
    kind: evm
    address: 0xE592427A0AEce92De3Edee1F18E0157C05861564
    typename: uniswap_v3_router

indexes:
  uniswap_swaps:
    kind: evm.subsquid.operations  # evm.digdug.operations, tezos.tzkt.operations
    datasource: subsquid_eth_mainnet
    handlers:
      - callback: on_multicall
        contract: uniswap_router_mainnet
        method: multicall  # multicall(int256)
        events:  # unordered list of possible events (not mandatory)
          - contract: uniswap_router_mainnet
            name: NewTrade
          - contract: token
            name: Transfer
  uniswap_events:
    kind: evm.subsquid.events  # tezos.tzkt.events
    datasource: subsquid_eth_mainnet
    handlers:
      - callback: on_new_trade
        contract: uniswap_router_mainnet
        name: NewTrade
